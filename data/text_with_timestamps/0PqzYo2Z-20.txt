00:00:00 - 00:00:13, Lan truyền ngược
00:00:13 - 00:00:26, Lan truyền ngược là một trong những thực toán rất phổ biến trong các mô hình học dựa trên Radiant
00:00:26 - 00:00:31, Và trong đó có rất nhiều mô hình hiện đại như Deep Learning, học sâu
00:00:31 - 00:00:38, Chuy tiết thực toán Backpropagation vượng hành như thế nào, chúng ta sẽ cùng tìm hiểu trong những trường sau
00:00:38 - 00:00:42, Đầu tiên chúng ta sẽ nhắc lại về mô hình dựa trên Radiant
00:00:42 - 00:00:49, Trong mô hình dựa trên Radiant, chúng ta phải tính toán giá trị y đoán là y ngã
00:00:49 - 00:00:53, Y ngã trong trường hợp này chính là bằng fθx
00:00:53 - 00:00:58, Và mình mong muốn là cho giá trị dự đoán sắp xỉ với giá trị thực tế
00:00:58 - 00:01:04, Thế thì có 3 công việc cần phải làm, chúng ta đang tập trung vào công việc cuối cùng
00:01:04 - 00:01:12, Đối với công việc tìm tham số tối ưu của mô hình, tức là tìm theta sao sau cho hàm lỗi này là nhỏ nhất
00:01:12 - 00:01:18, Trong hồi trước chúng ta đã nói có một số thuộc toán để tìm cái điện tối ưu
00:01:18 - 00:01:26, Cụ thể đó là Stochastic Radiant Descent, Momentum, Root Mean Square Propagation và Adam
00:01:26 - 00:01:34, Thế thì chúng ta sẽ cùng ôn lại các thuộc toán này, thì nó sẽ có những điểm đặc điểm gì chung
00:01:34 - 00:01:40, Chúng ta thấy là cả 3 thuộc toán giữa Momentum, Root Mean Square Propagation và Adam
00:01:40 - 00:01:47, Điểm chung đó là các thao tác phức tạp nhất được tính trên Radiant
00:01:47 - 00:01:52, Nghĩa là ở đây chúng ta thấy có rất nhiều các bước thực hiện, nhưng các bước này đều rất là đơn giản
00:01:52 - 00:01:56, Đó chỉ đơn giản là gánh giá trị và cộng trừ nhân chia
00:01:56 - 00:02:04, Nhưng mà riêng cái thao tác phức tạp nhất của cả 3 thuộc toán ở trên đó chính là tính đào hàm
00:02:04 - 00:02:09, Đây là tính đào hàm, và đây là tính đào hàm
00:02:09 - 00:02:16, Thế thì tại sao cái việc tính Radiant là khó, thì chúng ta sẽ có một số lý do sau
00:02:16 - 00:02:21, Đầu tiên đó là các hàm lỗi của mình, cái hàm Tri Theta của mình
00:02:21 - 00:02:33, Thường là những hàm rất phức tạp, vì nó có chứa cả hàm mô hình Fthx lẫn hàm để tính sai số giữa dự đoán và giá trị thực tế
00:02:33 - 00:02:38, Hay rất khác, đó là cái hàm Tri Theta của mình, nó sẽ là một cái hàm hợp
00:02:38 - 00:02:44, Hàm hợp tức là một cái hàm của rất nhiều những hàm thành phần bên trong
00:02:44 - 00:02:53, Trong đó là bao gồm Fthx và cái sai số, và cái hàm để tính sai số
00:02:53 - 00:03:04, Rồi lý do thứ 2 đó là cái mô hình của mình, thì nó không phải là một cái mô hình, là một cái hàm đơn biến mà nó có thể chứa rất nhiều tham số
00:03:04 - 00:03:13, Ví dụ Theta của mình, nó không phải là một giá trị Scalar, nó không phải là một cái biến đơn mà nó có thể chứa rất nhiều cái biến bên trong
00:03:13 - 00:03:19, Bao gồm là Theta1, Theta2, ThetaN
00:03:19 - 00:03:25, Thì đây là một cái hàm lỗi của mình, nó sẽ là một cái hàm đa biến theo Theta
00:03:25 - 00:03:34, Thì dưới đây sẽ là một số cái ví dụ Ctheta của mình, nó có thể là bằng một phần một cộng cho E mũ trừ ThetaX
00:03:34 - 00:03:41, Chúng ta lưu ý rằng là đây là cái thao tác thực hiện là nhân ma trận, nhân giữa vector và ma trận
00:03:41 - 00:03:46, Vector hoặc là ma trận
00:03:46 - 00:03:52, Hoặc nó cũng có thể là một cái hàm lồng trong hàm phức tạp như thế này
00:03:52 - 00:03:58, Một chi cho một cộng E mũ rồi lại trừ cho Theta chi cho một cộng E mũ, một cộng ThetaX
00:03:58 - 00:04:01, Thì đây là một vài cái ví dụ
00:04:01 - 00:04:08, Vậy thì công việc của chúng ta đó là làm sao chúng ta tính được đạo hàm của cái hàm này
00:04:08 - 00:04:14, Và lưu ý là đây mới chỉ là những hàm tương đối cơ bản đơn giản, chưa thực sự phức tạp
00:04:14 - 00:04:28, Trong các mô hình học sâu, ví dụ như chúng ta có những cái hàm Fx mà nó có thể là chứa F1 của F2, của F thứ 100X
00:04:28 - 00:04:32, Tức là nó có chứa 100 cái hàm thành phần
00:04:32 - 00:04:37, Các mô hình học sâu là cực kỳ phức tạp, do đó thì những hàm ở đây cũng chưa thực sự là quá phức tạp
00:04:37 - 00:04:47, Mà nó cũng đã khiến chúng ta đổ mô hơi hột để làm sao có thể tính thoáng được cái gradient, tức là đạo hàm cho cái vector
00:04:47 - 00:04:58, Vậy thì chúng ta sẽ nhắc lại cái kiến thức cũ của phổ thông và phòng giải tích 1 trong học kỳ 1 của lớp của đại học
00:04:58 - 00:05:02, Đó là chúng ta sẽ sử dụng cái đạo hàm của hàm hợp, công thức đạo hàm của hàm hợp
00:05:02 - 00:05:07, Với cái công cụ đó là quy tắc chuỗi hay còn gọi là chain rule
00:05:07 - 00:05:14, Thì ở đây chúng ta sẽ dùng cái chain rule để cho nó đồng bộ với các tài liệu biết bằng tiếng Anh
00:05:14 - 00:05:17, Và trong rất nhiều tài liệu thì họ vẫn dùng cái từ là chain rule
00:05:17 - 00:05:26, Vì việc sử dụng cái quy tắc chuỗi để tính đạo hàm của hàm hợp, đó là 1 trong những cái quy tắc cơ bản
00:05:26 - 00:05:38, Thì chúng ta nhắc lại, đó là ký hiệu hàm hợp fx là bằng fn, fn-1, v.v.v cho đến f1, tức là cái hàm này gồm có n hàm thành phần
00:05:41 - 00:05:48, Và với n hàm thành phần này thì chúng ta dùng cái hệ thống ký hiệu của phổ thông, tức là fx
00:05:48 - 00:05:57, Nhưng mà trong cái chương trình của cái môn máy học nâng cao thì chúng ta sử dụng cái hệ thống ký hiệu đó là g và theta
00:05:57 - 00:05:59, Thì nó cũng hoàn toàn tương tự như là fx
00:05:59 - 00:06:02, Bình thường chúng ta sẽ ghi là g của theta
00:06:02 - 00:06:10, Còn chúng ta dùng cái ký hiệu của fx để cho nó gần gũi với lại kế toán phổ thông để cho các bạn dễ theo dõi trước
00:06:10 - 00:06:17, Sau đó chúng ta sẽ áp dụng vào cái ký hiệu của các mô hình máy học sau, đó là g theta
00:06:17 - 00:06:19, Chúng ta sẽ dùng cái hệ thống này sau
00:06:19 - 00:06:22, Thì quyên tắc của tính gen ruin đó là gì?
00:06:22 - 00:06:27, Đó là đạo hàm của f theo x
00:06:27 - 00:06:33, Thì sẽ được tính bằng đạo hàm của f thứ n theo f thứ n-1
00:06:33 - 00:06:38, Tức là chúng ta xem fn-1 giống như là một biến, nó không phải là một hàm mà nó là một biến
00:06:38 - 00:06:42, Thì chúng ta sẽ tính đạo hàm của fn theo fn-1
00:06:42 - 00:06:45, Rồi nhân đạo hàm của fn-1 theo fn-2
00:06:45 - 00:06:49, Rồi cho đến đạo hàm fn-2
00:06:49 - 00:06:54, Đạo hàm 2 theo đạo hàm f1 và đạo hàm f1 theo x
00:06:54 - 00:06:59, Thì chúng ta thấy là cái công thức này nhìn rất là phức tạp
00:06:59 - 00:07:05, Lý do đó là vì có rất nhiều hệ thống ký hiệu và với rất nhiều hàm thành phần
00:07:05 - 00:07:11, Vậy thì chúng ta sẽ có một cái mẹo để nhớ cái quy tắc này
00:07:11 - 00:07:16, Đó là nếu như chúng ta dùng cái dấu gặt này
00:07:16 - 00:07:24, Thì là fd của fn-1 thì ở phía sau đó trên tử sẽ là dfn-1 và chúng ta thấy là nó sẽ khử nhau
00:07:24 - 00:07:29, Tử là có dfn-1, mẫu là có dfn-1, nó sẽ khử nhau
00:07:29 - 00:07:36, Rồi mẫu có dfn-2 thì ở phía sau đó sẽ là dfn-2
00:07:36 - 00:07:45, Tiếp tục cứ như vậy, ở đây là tử có dfn-1 và mẫu có dfn-1, nó sẽ khử
00:07:45 - 00:07:55, Vậy còn lại là gì? Chúng ta sẽ còn lại là dfn-dx, tức là đạo hàm của f theo x
00:07:55 - 00:07:58, Thì đây là một cái quy tắc để nhớ thôi
00:07:58 - 00:08:09, Đó là dfn-1, sau đó là n-1, n-2, n-2, n-3, rồi v.v. cho đến f2 theo f1 và f1 theo x
00:08:09 - 00:08:14, Thì x sẽ là cái biến số của mình, nó sẽ nằm ở cuối cùng ở đây
00:08:14 - 00:08:20, Thì chúng ta sẽ xét một cái ví dụ cho đơn giản và trực quan
00:08:20 - 00:08:27, Ví dụ như fx, iz là bằng x cộng i, tất cả nhân với z
00:08:27 - 00:08:39, Thì ở đây giả sử như chúng ta xem xét là, chúng ta tại một thời điểm thì chúng ta chỉ xét với một biến x
00:08:39 - 00:08:45, Tức là tất cả những cái hàm ở trên đây sẽ được đưa về cái hàm chỉ có một biến thôi
00:08:45 - 00:08:51, Thì đặt cái công việc đầu tiên chúng ta phải tính toán, đó là cái việc tính x cộng i
00:08:51 - 00:08:56, Đây là cái thao tác đầu tiên chúng ta tính, thì đây sẽ là điều diễn bởi hàm f1
00:08:56 - 00:09:04, Sau khi chúng ta tính cái f1 là x cộng i xong, thì chúng ta sẽ lại nhân với z, thì đây sẽ là hàm f2
00:09:04 - 00:09:14, Nhưng ở đây chúng ta sẽ xét trên một biến x trước, thì f1x sẽ là bằng x cộng i
00:09:14 - 00:09:18, Sau đó chúng ta lại lấy f1 nhân với z để ra f2
00:09:18 - 00:09:28, Như vậy công thức của f2 mà theo cái biến x thì nó sẽ là bằng f1 nhân với z
00:09:28 - 00:09:34, Nhưng mà trong trường hợp này, f1 của chúng ta chính là cái biến số của mình
00:09:34 - 00:09:43, Thì khi đó, fx của mình, cái công thức fx ban đầu của mình sẽ là bằng f2 của f1x
00:09:44 - 00:09:52, Khi chúng ta thế vào, thì f2 chính là z nhân x
00:09:52 - 00:10:02, Do đó, f2 của f1x sẽ là bằng z nhân cho xx, trong trường hợp này chính là f1
00:10:02 - 00:10:08, F1 chúng ta sẽ thế vào bằng công thức này, đó là x cộng i
00:10:09 - 00:10:19, Rồi, khi đó thì đạo hàm của f1 theo x, nuối là ở đây chúng ta chỉ đang xét với một biến x thôi
00:10:19 - 00:10:25, Chúng ta sẽ làm cái việc tương tự, cái việc này tương tự cho biến i, chúng ta sẽ làm sao
00:10:25 - 00:10:32, Đạo hàm của f1 theo x, thì đạo hàm của f1 theo x chính là trong công mắc của x, thì i chính là hàng số
00:10:32 - 00:10:37, Do đó đạo hàm của f1 theo x chính là 1
00:10:37 - 00:10:48, Rồi, đạo hàm của f2 theo f1 là bao nhiêu? Đạo hàm của f2 theo f1, tức là chúng ta sẽ tính đạo hàm của cái này theo x
00:10:48 - 00:10:58, Chúng ta sẽ tính đạo hàm của cái này theo x, thì trong biến x, thì z chính là hàng số do đó đạo hàm của cái này sẽ là bằng z
00:10:58 - 00:11:01, Đạo hàm của f2 theo f1 chính là z
00:11:02 - 00:11:15, Rồi, như vậy thì chúng ta sẽ sử dụng, áp dụng cái công thức general là d của f theo x sẽ là bằng df2 theo f1
00:11:15 - 00:11:22, Sau đó df1 theo x, thì df2 theo f1 chính là z, nguyên cái cọp này sẽ là z
00:11:22 - 00:11:28, Và df1 theo x chính là 1
00:11:28 - 00:11:36, Như vậy z nhân 1 chính là bằng z, như vậy đạo hàm của f theo x sẽ là bằng z
00:11:36 - 00:11:45, Hoàn toàn tương tự cho i và z, chúng ta sẽ làm cái công việc này cho đạo hàm của f theo i và đạo hàm của f theo z
00:11:46 - 00:11:48, Thì đối với biến i
00:11:48 - 00:11:58, Vì chúng ta có nhiều biến nên tại một thời điểm chúng ta chỉ xem xét một biến thôi
00:11:58 - 00:12:02, Thì công việc đầu tiên chúng ta sẽ tính toán, đó là phép cộng ở đây
00:12:02 - 00:12:09, Thì f1 của ta, bây giờ nó không phải là biến x nữa mà sẽ là biến theo i, thì nó vẫn sẽ là bằng x cộng i
00:12:09 - 00:12:19, Và f2 của mình theo biến i thì nó cũng sẽ là bằng giá trị f1 nhân với z
00:12:19 - 00:12:24, Và f1 theo nhân với z như vậy sẽ là z nhân với i
00:12:24 - 00:12:30, Tại vì trong trường hợp này f1 của mình sẽ làm biến số, f1 của mình sẽ là biến số
00:12:30 - 00:12:33, Như vậy thì f2 i là bằng z i
00:12:33 - 00:12:46, Và khi đó thì công thức f của i sẽ là bằng f2 của f1 của i
00:12:46 - 00:12:53, Thì x cộng i là x cộng i
00:12:53 - 00:13:02, Rồi, f2 của f1 là z nhân với i
00:13:02 - 00:13:06, Thay là z nhân với lại cái f1 này
00:13:06 - 00:13:09, Mà f1 của mình là x cộng i
00:13:09 - 00:13:20, Tức là khi chúng ta triển khai ở đây thì f1 i chính là chúng ta xem nó như là một cái biến
00:13:20 - 00:13:26, Rồi chúng ta triển khai vô thì nó sẽ là z nhân với lại cái biến
00:13:26 - 00:13:31, Tức là z nhân với f1, mà f1 thì nó lại là bằng x cộng i
00:13:31 - 00:13:35, Rồi, khi đó chúng ta sẽ tính đạo hàm
00:13:35 - 00:13:41, Đạo hàm là d của f1 theo i
00:13:41 - 00:13:44, D của f1 theo i thì nó sẽ là bằng 1
00:13:44 - 00:13:47, Tại trong có mắt của i thì x là bằng hàng số
00:13:47 - 00:13:53, D của f2 theo f1
00:13:53 - 00:13:56, Tức là đạo hàm của công thức này
00:13:56 - 00:14:00, Và đạo hàm của công thức này là bằng z
00:14:00 - 00:14:06, Rồi, như vậy thì chúng ta sẽ có đạo hàm của f theo biến i
00:14:06 - 00:14:11, Chính là bằng đạo hàm của f2 theo f1
00:14:11 - 00:14:16, Nhân cho đạo hàm của f1 theo i
00:14:16 - 00:14:19, Vì f2 theo f1 chính là bằng z
00:14:19 - 00:14:24, Và df1 theo i chính là bằng 1, không bằng z
00:14:24 - 00:14:30, Tương tự như vậy chúng ta sẽ tính cho đạo hàm của f theo z
00:14:30 - 00:14:38, Thì chúng ta thấy là cái cách làm này, GenRui này thì nó sẽ rất là bài bảng và có thể tổn qua khóa được
00:14:38 - 00:14:48, Và bây giờ chúng ta sẽ tìm cách biểu diễn cái công thức của cái fx, iz này dưới dạng là biểu đồ, đồ thị tính toán
00:14:48 - 00:14:53, Như sau, đầu vào chúng ta sẽ có x, y và z
00:14:53 - 00:14:58, Bước đầu tiên chúng ta sẽ thực hiện là lấy x, y, đây là tán tự cộng
00:14:58 - 00:15:02, Và đầu ra của mình sẽ là hàm f1
00:15:02 - 00:15:12, Sau đó chúng ta lấy cái z này đen nhân với cái f1 để ra cái f2, thì đây chính là cái hàm f của mình
00:15:12 - 00:15:17, Rồi, thì đây là cái cách biểu diễn dưới dạng đồ thị tính toán
00:15:17 - 00:15:25, Trong đó mỗi một cái node tính toán sẽ là một tán tử và đầu vào nó sẽ nhận các cái biến số
00:15:25 - 00:15:33, Thế thì chúng ta sẽ đến với một trong những thực toán đầu tiên, đó chính là thực toán Feed Forward
00:15:33 - 00:15:37, Tức là trước khi thực hiện Backpropagation, Backpropagation là lang truyền nghịch
00:15:37 - 00:15:43, Thì chúng ta sẽ phải làm cái thực toán lang truyền thuận, tức là chúng ta sẽ đi tính cái giá trị của hàm f trước
00:15:43 - 00:15:51, Vựa trên cái đồ thị tính toán, thì giá sử ở đây chúng ta vẫn sử dụng các cái hàm như đã nêu ở trên
00:15:51 - 00:15:57, Thì x, x nó sẽ là bằng f2 của f1, x thì đầu tiên ta sẽ xây dựng cái đồ thị tính toán
00:15:57 - 00:16:08, Rồi sau đó chúng ta sẽ tính giá trị tại các cái node, biết rằng là chúng ta sẽ chọn ra một cái bộ giá trị x, y, z khởi tạo bằng đầu
00:16:08 - 00:16:10, Đây chính là cái giá trị khởi tạo
00:16:10 - 00:16:20, Và chúng ta sẽ đi tính đạo hàm tại cái giá trị x mừng 3, y bằng trừ 4 và z mừng 5
00:16:20 - 00:16:27, Đầu tiên đó là chúng ta sẽ xây dựng cái đồ thị tính toán, giống như ở trong slide trước, thì đây chính là đồ thị tính toán
00:16:27 - 00:16:32, Và chúng ta sẽ có các cái node là node cộng, rồi node nhân
00:16:32 - 00:16:42, Sau đó chúng ta sẽ lần lược thay các cái giá trị này vào các cái node, thì x là bằng 3, y là bằng trừ 4 và z là bằng 5
00:16:42 - 00:16:47, Sau đó chúng ta cứ lần lược lang truyền thuận lên, lang truyền thuận về phía trước
00:16:47 - 00:16:56, Đầu tiên đó là thực hiện phép cộng, thì f1 bước này nó sẽ là bằng 3 cộng cho trừ 4, thì nó sẽ là bằng trừ 1
00:16:56 - 00:17:02, Sau khi chúng ta đã tính f1 xong, thì chúng ta sẽ thực hiện cái node phép nhân
00:17:02 - 00:17:13, Thì f2 nó sẽ là bằng f1 nhân với trừ 5, tức là f1 nhân với 5, tức là bằng trừ 1 nhân với 5 là bằng trừ 5
00:17:13 - 00:17:21, Như vậy thì cái thuật toán lang truyền thuận đó là một cái thuật toán quan trọng để giúp chúng ta xây dựng cái đồ thị tính toán
00:17:22 - 00:17:25, Cái bước quan trọng đầu tiên đó là xây dựng được cái đồ thị tính toán
00:17:25 - 00:17:35, Là một cái bước tiền đề quan trọng trước khi chúng ta có thể tính được cái đạo hàm của hàm f theo các cái biến x này, các cái biến x, x, y, z này
