00:00:00 - 00:00:22, Chúng ta sẽ cùng đến với một trong những cái cải tiến đầu tiên của thức toán Gradient Descent, đó chính là biến thể momentum
00:00:23 - 00:00:40, Momentum có thể nói là một trong những biến thể quan trọng và ý tưởng của nó đã được kế thường và sử dụng rất nhiều trong các thức toán optimizer trên các mô hình gradient base
00:00:40 - 00:00:51, Và ý tưởng của momentum là gì? Và tại sao có thể đề xuất ra được cái cải tiến này? Chúng ta sẽ cùng tìm hiểu trong những phần tiếp theo
00:00:51 - 00:00:56, Đầu tiên chúng ta sẽ nhắc lại về thức toán gradient descent
00:00:56 - 00:01:08, Ở bên tay trái đó chính là cái thức toán được biết một cách đầy đủ là khởi tạo tham số, cụ thể đây là theta là bằng một cái random
00:01:08 - 00:01:20, Rồi sau đó chúng ta sẽ đi tính đạo hàm của hàm lỗi theo từng thành phần của theta
00:01:20 - 00:01:31, Sau đó chúng ta sẽ cập nhật lại các cái tham số là theta mới thì sẽ là bằng theta cũ trừ cho anh pha dân cho đạo hàm của hàm lỗi theo theta
00:01:31 - 00:01:37, Và cái bước cập nhật này sẽ được thực hiện đi, thực hiện lại nhiều lần
00:01:37 - 00:01:46, Thế thì để cho gọn chúng ta sẽ lấy cái phần lỗi nhất của cái thức toán gradient descent, đó chính là cái bước cập nhật tham số này
00:01:46 - 00:01:56, Và chúng ta sẽ lập cho đến khi nào mà cái theta của mình nó hồi tụ, thì cái hồi tụ ở đây có nghĩa là nó sẽ không có giảm xuống được nữa
00:01:56 - 00:02:08, Và chúng ta sẽ đến với cái cải tiến đầu tiên của momentum, thì trước khi đến cái cải tiến chúng ta phải nói về cái vấn đề của nó đang gặp là gì
00:02:08 - 00:02:16, Vấn đề số 1 đó là làm sao để một cái learning rate chúng ta có thể chọn nó một cái learning rate tốt
00:02:16 - 00:02:30, Thì cái vấn đề này xảy ra khi chúng ta quan sát vào cái thức toán gradient descent, chúng ta thấy cái anh pha này đống vai trò rất là quan trọng trong cái việc hồi tụ của mô hình
00:02:30 - 00:02:39, Nếu như anh pha của mình mà quá nhỏ thì cái mô hình của mình nó sẽ hồi tụ dọng, lấy ví dụ như ở đây là cái hàm loss
00:02:39 - 00:02:47, Và khi mà cái anh pha mà quá nhỏ thì nó sẽ nhảy xuống từng cái bước rất là nhỏ, những cái bước dò dõng rất là nhỏ
00:02:47 - 00:02:52, Và vì nó đi chậm như vậy nên cái hồi tụ nó sẽ chậm
00:02:52 - 00:03:09, Nước lại nếu anh pha mà lớn, thậm chí là rất lớn thì nó có thể nhảy qua bên đây, thoát ra khỏi cái điểm lẽ ra nó phải đến được, nó lại nhảy qua bên đây, xong rồi qua đây
00:03:09 - 00:03:14, Và cứ như vậy là thoát ra khỏi cái điểm tuyêu
00:03:14 - 00:03:22, Vậy thì learning rate cần phải được điều chỉnh giảm dần hay còn gọi là dampening
00:03:22 - 00:03:33, Thế thì tại sao lại như vậy? Nếu như ban đầu chúng ta không biết learning rate là bao nhiêu thì chúng ta sẽ cho nó một cái giá trị bụi lớn
00:03:33 - 00:03:40, Và có thể chấp nhận là nó sẽ dần dần có thể ban đầu nó sẽ thoát ra khỏi cái điểm cực tiểu
00:03:40 - 00:03:56, Tuy nhiên ở những cái vòng lập sau nó sẽ giảm dần, nhỏ dần và đến lúc đạt được cái giá trị learning rate mà tối ưu, tức là hội tụ về cái điểm cực tiểu nhưng đồng thời là không đi quá chậm
00:03:56 - 00:04:00, Thì đó là cái ý tưởng của cái cải tiến
00:04:00 - 00:04:11, Vậy thì ở đây chúng ta sẽ có một cái bước khởi tạo đó là alpha ban đầu là bằng 0.5 thì đây là một cái con số khá là lớn
00:04:11 - 00:04:19, Và chúng ta sẽ lập cho đến chi hội tụ thì chúng ta sẽ cho alpha là bằng delta nhân chế alpha
00:04:19 - 00:04:26, Trong đó delta chính là cái hệ số dampening, dampening factor nó có giá trị từ 0 cho đến 1
00:04:26 - 00:04:32, Thì ở đây chúng ta sẽ thử trả lời cho cái câu hỏi là điều gì xảy ra nếu delta bằng 0
00:04:32 - 00:04:46, Nếu delta bằng 0, tức là alpha sẽ là bằng 0 nhân với cái alpha cũ thì alpha sẽ bị trực tiêu và khi đó cái phần này nó sẽ là bằng 0, tức là theta sẽ không cập nhật
00:04:46 - 00:05:12, Nguyện lại nếu delta mà bằng 1, tức là alpha sẽ không giảm mà alpha không giảm, tức là quá trình cập nhật này nó tại những thời điểm đầu tiên nó sẽ có thể bị phân kỳ như thế này
00:05:12 - 00:05:23, Nếu chúng ta không khéo cho delta là lớn hơn 0 và nó phải bé hơn 1
00:05:23 - 00:05:34, Để thụ tiện cho chúng ta bàn đến những cái cải tiến tiếp theo thì chúng ta sẽ đặt một cái biến, nó gọi là biến vận tốc
00:05:34 - 00:05:48, Thế thì theta bằng theta trừ cho alpha nhân cho đạo hàm thì chúng ta sẽ xét nguyên cái vế này sẽ là cái biến V, tức là cái vận tốc cập nhật tham số của mình
00:05:48 - 00:06:00, Tại sao dùng từ vận tốc? Tại vì nó tả hiện cho cái việc di chuyển nhanh hay không nhanh, nếu như cái V này lớn thì delta sẽ được cập nhật nhanh
00:06:00 - 00:06:19, Nếu V mà nhỏ thì theta sẽ cập nhật rất chọc, do đó chúng ta sẽ viết lại thực toán của mình, đó là lập cho đến khi hồi tụ và chúng ta tạo ra một cái biến vận tốc V ở đây
00:06:19 - 00:06:39, Vậy thì vấn đề ở đây là gì? Tốc độ hồi tụ sẽ rất chậm hoặc là nó sẽ bị mắc kẹt hay gọi là get stuck tại các điểm cực tiễm của cuộc bộ
00:06:39 - 00:06:59, Nếu dùng từng từng tập nhật, chúng ta sẽ có một cái hàm j là hàm lỗi như sau, nếu như chúng ta khởi tạo, nó sẽ nằm ở những cái điểm mà không phải là tụ tiểu toàn cục, mà nó sẽ nằm ở cái phía như thế này
00:06:59 - 00:07:11, Vậy thì khi chúng ta cập nhật nó về đây thì nó sẽ bị mắc kẹt tại cái điểm cực tiễm của cuộc bộ này
00:07:11 - 00:07:26, V sẽ có xu hướng là ban đầu sẽ rất là nhanh, nhưng mà càng đến đây, càng đến cái điểm cực tiễm của cuộc bộ thì nó sẽ chậm dần
00:07:26 - 00:07:43, Tại sao lại như vậy? Tại vì khi tham số của mình càng tiến về điểm cực tiễm của cuộc bộ, mà điểm cực tiễm của cuộc bộ có tính chất đó là đạo hàm gần bằng 0
00:07:43 - 00:07:54, Mà khi đạo hàm sắp xỉ bằng 0 thì tức đó, tức là cái v, v này của chúng ta, v là bằng an pha nhân đạo hàm thì nó cũng sẽ sắp xỉ bằng 0
00:07:54 - 00:08:01, Và khi đó thì theta bằng theta trừ cả một con số rất là bé, tức là nó sẽ đi rất là chậm
00:08:02 - 00:08:11, Tại khi cái v có xu hướng giảm dần và tiến về 0 như vậy thì nó sẽ gây ra cái việc hội tụ chậm
00:08:11 - 00:08:18, Và chúng ta sẽ mượn cái khái niệm trong vật lý là momentum để giải quyết vấn đề này
00:08:18 - 00:08:25, Momentum là gì? Dạ xử như ban đầu, chúng ta đặt một cái quả banh ở đây
00:08:25 - 00:08:32, Thì ở trên cao nó sẽ có một cái thế năng, nó sẽ khiến cho cái trái banh nó sẽ rớt xuống
00:08:32 - 00:08:37, Nhưng khi mà trái banh nó rớt xuống đến cái điểm cực tiễm của cuộc bộ ở đây
00:08:42 - 00:08:50, Về lúc đó cái thế năng nó đã bị trực tiêu bằng 0, thế năng trong trường hợp này là chính là đạo hàm
00:08:50 - 00:08:55, Nó sẽ tương đương với đạo hàm ở trên
00:08:55 - 00:09:03, Và thế năng thì nó bằng 0, nhưng bù lại nó sẽ có cái động năng là do quả banh đi từ trên xuống dưới
00:09:03 - 00:09:09, Ban đầu động năng là bằng 0, nhưng mà sau đó rớt xuống dưới thì cái động năng của quả banh nó lớn lên
00:09:09 - 00:09:17, Và nhờ có cái động năng này, nó sẽ tạo ra một cái moment để cho cái quả banh này tương đương với đạo hàm ở trên
00:09:17 - 00:09:22, Rớt xuống được cái điểm cực tiễm mà tốt hơn
00:09:22 - 00:09:26, Và đó chính là cái ý tưởng cho giải pháp số 2
00:09:26 - 00:09:37, Đó là cái vận tốc của chúng ta thì sẽ được kế thừa từ cái vận tốc của quá khứ V bằng beta nhân V
00:09:37 - 00:09:40, Đây là cái quá khứ
00:09:40 - 00:09:50, Nếu không có cái thành phần beta V này thì V của chúng ta chỉ bao gồm cái thành phần thế năng chính là cái đạo hàm ở đây
00:09:50 - 00:09:58, Nhờ nó khai thác được cái lượng động năng của quá khứ thì khi nó chạm đến cái điểm cực tiễm của bộ
00:09:58 - 00:10:02, Nó sẽ giúp cho chúng ta thoát ra khỏi cái bụng này
00:10:02 - 00:10:07, Thì cái công thức cải tiến của chúng ta sẽ rất là đơn giản như trên
00:10:07 - 00:10:16, Và beta lúc này nó gọi là momentum factor và beta cũng là từ 0 cho đến 1
00:10:16 - 00:10:21, Điều gì xảy ra nếu beta bằng 0, beta bằng 1
00:10:21 - 00:10:26, Nếu beta bằng 0 thì nó sẽ bỏ ra một cái vận tốc của chúng ta
00:10:26 - 00:10:30, Điều gì xảy ra nếu beta bằng 0, beta bằng 1
00:10:30 - 00:10:35, Nếu beta bằng 0, tức là chúng ta không có cái thành phần động năng này
00:10:35 - 00:10:41, Vậy thì beta bằng 0 chính là cái trường hợp không có cải tiến
00:10:45 - 00:10:54, Rồi, khi beta bằng 1 thì lúc này V sẽ là bằng 9V cộng dồn vào cái thế năng
00:10:54 - 00:10:57, Thì khi đó cái tốc độ tăng của V này rất là cao
00:10:57 - 00:11:00, V nó sẽ là cộng dồn lên, cộng dồn lên, cộng dồn lên
00:11:00 - 00:11:04, Như vậy thì nó sẽ tăng rất là nhanh
00:11:12 - 00:11:23, Nó có thể khiến cho cái vận tốc của mình quá lớn và nó sẽ không có hồi tụ mà nó sẽ bị phân kiệt
00:11:23 - 00:11:30, Do đó thì beta nó nên là một con số nhỏ hơn một
00:11:30 - 00:11:43, Tức là nó chỉ lấy một phần, ví dụ như trong trường hợp là beta bằng 0.9 thì nó lấy 90% của cái V qua khứ thôi
00:11:45 - 00:11:50, Thì chúng ta sẽ có cái giải pháp đầy đủ cho cái momentum
00:11:50 - 00:11:57, Đầu tiên chúng ta sẽ khởi tạo alpha là một cái giá trị khá là lớn
00:11:59 - 00:12:08, Và sau đó thì alpha sẽ được cập nhật lại là bằng delta nhân cho alpha, tức là nó đang giảm dần
00:12:08 - 00:12:16, Cái alpha, rồi chúng ta sẽ khởi tạo vận tốc ban đầu
00:12:16 - 00:12:25, Khi chúng ta tưởng tượng kết quả ban ở trên đây thì cái động năng của nó là bằng 0, nó không có động năng mà nó chỉ có thế thăng thôi
00:12:25 - 00:12:30, Thì lúc này V của mình là bằng 0, tức là tượng trừng cho động năng tại thời điểm bắt đầu
00:12:31 - 00:12:39, Delta là cái hệ số giảm, tức là alpha ban đầu là 0.5 nhưng mà sau đó nó sẽ giảm 10 lần
00:12:39 - 00:12:45, Và 0.1 có nghĩa là chia cho 10 thì nó sẽ giảm 10 lần, cứ mỗi lần lập nó sẽ giảm 10
00:12:45 - 00:12:50, Và beta là bằng 0.9
00:12:50 - 00:13:02, Tức là cái động năng, cái vận tốc của mình sẽ là bằng 90% của cái vận tốc quá khứ
00:13:02 - 00:13:06, Sau đó chúng ta cộng thêm cái thành phần thế năng hiện tại, tức là cái đạo hàm
00:13:06 - 00:13:10, Cái này tượng trưng cho cái thế năng hiện tại
00:13:10 - 00:13:20, Nếu như đến cái điểm, gần đến cái điểm cực tiểu, cục bộ ở đây
00:13:20 - 00:13:29, Thì cái thành phần đạo hàm này nó sẽ sắp xỉ bằng 0 nhưng nó sẽ kế thừa được 90% cái động năng của quá khứ
00:13:29 - 00:13:35, Nên nó sẽ không có bị dừng lại, bị đứng lại
00:13:35 - 00:13:39, V vẫn còn đủ lớn để có thể được chuyển được
00:13:39 - 00:13:47, Và ở đây chúng ta thấy là khi chúng ta, cái điểm màu đỏ đến tại vị trí này
00:13:47 - 00:13:50, Nó sẽ vẫn còn một cái động năng để nhảy qua đây
00:13:50 - 00:13:53, Sau đó tiếp tục nhảy lên, nhảy lên, nhảy lên
00:13:53 - 00:14:00, Và nếu như cái động năng này đủ lớn thì nó sẽ giúp cho chúng ta thoát ra khỏi cái điểm, cái khu vực bên này
00:14:00 - 00:14:03, Thoát ra khỏi cái khu vực cực tiểu cục bộ
00:14:09 - 00:14:11, Và để qua một cái khu vực khác
00:14:11 - 00:14:17, Với hy vọng rằng là chúng ta có thể tìm ra được một cái cực tiểu tốt hơn
00:14:17 - 00:14:24, Và ở đây thì chúng ta sẽ thử tính toán trên những cái con số
00:14:24 - 00:14:28, Đầu tiên đó là giả xử như cái momentum của mình là bằng 0.99
00:14:28 - 00:14:32, Thì khi đó 3 cái bước cập nhật đầu tiên, 3 cái bước cập nhật đầu tiên của mình
00:14:32 - 00:14:38, V ban đầu thì sẽ là bằng G, trong đó G chính là cái radian
00:14:41 - 00:14:44, Tại cái vị trí khởi tạo chính là G1 ở đây
00:14:44 - 00:14:48, Tức là nó chỉ bao gồm thế năng thôi, động năng lúc này là 0
00:14:48 - 00:14:53, Ở đây đúng ra là 0 cộng cho G1
00:14:53 - 00:15:02, Sau đó V2 sẽ là bằng 90% của cái củ
00:15:05 - 00:15:12, Sau đó cộng thêm 1 thằng G2, thì nó chính là bằng 0.99 v.1 v.1 trước này là G
00:15:12 - 00:15:16, Nó chính là 0.99 v.1 cộng cho G2
00:15:16 - 00:15:19, Tiếp tục sang cái điểm thứ 3
00:15:19 - 00:15:24, V3 sẽ là bằng 0.99 v.2 cộng cho G3
00:15:24 - 00:15:27, Tức là cái đảo hàng tại thời điểm hiện tại
00:15:27 - 00:15:36, G3 ở đây, cộng cho, nó sẽ cộng cho khoảng 0.99 v.2
00:15:36 - 00:15:41, Chúng ta thế cái V2 ở cái công thức ở trên xuống đây
00:15:41 - 00:15:46, Thì nó sẽ là bằng 0.99 v.1 cộng cho G2
00:15:46 - 00:15:55, Chúng ta triển khai vào thì nó sẽ ra là 0.81 v.1 và 0.99 v.2 cộng cho G3
00:15:55 - 00:15:58, Như vậy thì ở đây chúng ta sẽ có một cái nhận xét
00:15:58 - 00:16:02, Đó là khi cập nhật tham số, thì gradient tại những cái bước càng gần
00:16:02 - 00:16:04, Nó sẽ đóng góp càng nhiều
00:16:04 - 00:16:09, Tức là V tại cái thời điểm thứ 3, tức là cái thời điểm hiện tại chúng ta đang xét
00:16:09 - 00:16:18, Nó sẽ bao gồm là 0.81 v.1 cộng cho 0.991 v.2 cộng cho G3
00:16:18 - 00:16:22, Tức là cái thế năng tức thời, tức là đảo hàng tức thời của mình
00:16:22 - 00:16:27, Thì chúng ta thấy là tại cái vị trí số 3
00:16:27 - 00:16:33, G3 đóng vai trò là cái tỷ lệ, cái hệ số là 1
00:16:33 - 00:16:35, Tức là cao nhất
00:16:35 - 00:16:40, Sau đó là G2 sẽ đóng góp là 0.9 và G3 là 0.81
00:16:40 - 00:16:46, Như tương tự như vậy thì khi G, khi V mà càng lớn
00:16:49 - 00:16:55, Thì nó sẽ là bằng cái hệ số của những cái V
00:16:55 - 00:17:03, Gn cộng cho Gn-1 cộng cho Gn-2
00:17:03 - 00:17:07, Và sau đó nó sẽ nhân với những cái hệ số thấp dần
00:17:07 - 00:17:13, Ban đầu sẽ là 1, 0.9, 0.81
00:17:13 - 00:17:17, Tiếp theo thì nó sẽ là 0.9 nhân cho 0.81
00:17:17 - 00:17:23, Nó sẽ cộng cho 0.9 nhân cho 0.81
00:17:23 - 00:17:31, Tức là đâu đó khoảng sắp xỉ là 0.72 của cái G thứ n-3
00:17:31 - 00:17:36, Càng sau đó hệ số nó càng thấp
00:17:36 - 00:17:42, Đây chính là cái ý tưởng của tục toán momentum
00:17:42 - 00:17:47, Và nó đã giúp cho chúng ta thoát ra được khỏi cái điểm thực tiểu cục bộ
00:17:47 - 00:17:55, Nhờ cái việc là chúng ta khai thác được những cái động năng của quá khứ
00:17:55 - 00:18:01, 90% của Gn-1, 80% của Gn-2 và 70% của Gn-3
00:18:01 - 00:18:04, Nó khiến cho chúng ta thoát ra được
00:18:04 - 00:18:10, Và khi thoát ra được thì câu hỏi là lượt có khi nào mà nó cứ đi lên hoài hay không
00:18:10 - 00:18:15, Thì câu trả lời là không, tại vì khi mà nó thoát ra đến đây
00:18:15 - 00:18:24, Rồi, thì đến đây cái lúc này thì nó sẽ kế thừa những cái thế năng của cách đây
00:18:24 - 00:18:29, Trước đó thì thế năng tại những thời điểm này rất là thấp
00:18:29 - 00:18:32, Cái khu vực này rất là thấp
00:18:36 - 00:18:47, Thì những cái Gn rất thấp này nó lại đóng góp tỷ trọng cao vào cái vị trí của cái time số hiện giờ
00:18:47 - 00:18:52, Còn những cái điểm mà có động năng thế năng cao, ví dụ như chỗ này
00:18:52 - 00:18:58, Thì thế năng của nó rất là cao, nhưng mà nó đã đi xa so với cái vị trí này
00:18:58 - 00:19:02, Nên cái hệ số ở đây nó chỉ có thể đóng góp là tầm 0.1, 0.2 thôi
00:19:02 - 00:19:10, Còn những cái đóng góp nhiều nhất vào đây đó là những cái thế năng tại vị trí này
00:19:10 - 00:19:16, Tức là đạo hàm ở những cái khu vực rất là thấp, đó thì nó dẫn đến nó sẽ kéo cái này xuống ngược trở lại
00:19:17 - 00:19:24, Rồi, và khi kéo ngược trở lại thì nó lại tiếp tục chạy qua chạy lại và cho đến khi nào mà chạm được đến cái điểm này
00:19:24 - 00:19:28, Thì đó chính là cái ý tưởng của momentum
