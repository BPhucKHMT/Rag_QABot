0:00:14 - 0:00:20, Bây giờ chúng ta sẽ đến với một cái ví dụ cụ thể để chúng ta có thể dễ dàng hình dung hơn.
0:00:20 - 0:00:25, Thì ở đây chúng ta set một cái mạng Neural Network gồm cụ thể đó là 10 lớp biến đổi.
0:00:25 - 0:00:31, Và các cái hàm kích hoạt của mình ở đây chúng ta sẽ sử dụng cùng một hàm kích hoạt đó là hàm sigmoid.
0:00:31 - 0:00:42, Thì công thức của cái hàm sigmoid đó là bằng một phần một cộng e mũ trừ x.
0:00:42 - 0:00:45, Thì đây là cái công thức của sigmoid.
0:00:46 - 0:00:55, Và khi chúng ta huấn luyện cái mạng Neural Network này thì chúng ta sẽ đi tính cái hàm loss. Đây là hàm lỗi.
0:00:55 - 0:01:00, Và chúng ta sử dụng cái binary cross entropy tại vì ở đây chúng ta dùng hàm kích hoạt là sigmoid.
0:01:00 - 0:01:05, Nên cái giá trị đầu ra của mình là con số từ 0 cho đến 1.
0:01:05 - 0:01:08, Và chúng ta sẽ đi so với cái giá trị e này.
0:01:08 - 0:01:21, Sau đó thì khi chúng ta tính đạo hàm, ở đây là chúng ta sẽ tính đạo hàm theo cái biến theta.
0:01:21 - 0:01:24, Thế thì cái công thức này chúng ta sẽ triển khai như thế nào?
0:01:24 - 0:01:37, Đối với cái mạng Neural Network mà có 10 lớp, thì ở cái lớp đầu tiên chúng ta sẽ có bộ hệ số đó là theta 1.
0:01:37 - 0:01:40, Theta 1.
0:01:40 - 0:01:45, Sau đó chúng ta sẽ nhân với cái x là cái dữ liệu đầu vào.
0:01:45 - 0:01:51, Và ngay sau đó chúng ta sẽ thực hiện cái hàm kích hoạt để tạo ra cái giá trị đầu ra.
0:01:51 - 0:01:57, Thì sigmoid của theta 1 x, thì đây chính là cái lớp biến đổi đầu tiên là layer số 1.
0:02:00 - 0:02:05, Sau đó chúng ta lại tiếp tục lan truyền đến cái layer thứ 2.
0:02:08 - 0:02:12, Và cũng tương tự như vậy chúng ta sẽ có cái tham số là theta 2.
0:02:12 - 0:02:20, Thì theta 2 sẽ nhân với cái đầu ra của cái lớp trước đó chính là, ở đây theta 2 sẽ nhân với lại cái đầu ra trước đó.
0:02:20 - 0:02:24, Và sau đó chúng ta qua cái hàm sigmoid.
0:02:24 - 0:02:27, Qua cái hàm sigmoid.
0:02:27 - 0:02:31, Thì đây chính là cái kết quả của layer số 2.
0:02:31 - 0:02:39, Cứ như vậy, cho đến cái sigmoid của theta 10, tức là chúng ta đang tiến đến theta 10.
0:02:39 - 0:02:46, Thì theta 1 tương ứng layer 1, theta 2 tương ứng layer số 2, và theta 10 tương ứng layer số 10.
0:02:46 - 0:02:53, Thì đây chính là cái công thức của cái hàm mà chúng ta cần phải tối ưu hóa hàm j, hàm lỗi.
0:02:54 - 0:03:01, Thì nhìn trong cái công thức này, chúng ta sẽ đi tính đạo hàm của j theo từng thành phần của tham số theta.
0:03:01 - 0:03:05, Lưu ý là theta là một tập hợp các cái tham số.
0:03:05 - 0:03:07, Là một tập hợp các cái tham số.
0:03:07 - 0:03:09, Nó sẽ bao gồm là theta 1.
0:03:09 - 0:03:12, Trong theta 1 nó lại gồm có nhiều cái thành phần con nữa.
0:03:12 - 0:03:17, Đó là cái trọng số tương ứng với cái cạnh nối của lớp trước với lớp sau.
0:03:17 - 0:03:21, Thì đây là tập hợp các cái tham số.
0:03:21 - 0:03:22, Rồi.
0:03:22 - 0:03:30, Và chúng ta sẽ đi tính đạo hàm từng phần là đạo hàm của delta j chia cho delta theta i.
0:03:30 - 0:03:37, Thì nó sẽ là bằng công thức của đạo hàm của bce theo cái hàm sigmoid.
0:03:37 - 0:03:40, Đạo hàm của sigmoid theo cái hàm p10.
0:03:40 - 0:03:46, Thì cái p10 này nó chính là cái thao tác nhân của theta 10 với lại cái thành phần còn lại.
0:03:46 - 0:03:48, Đây chính là cái phép nhân của theta 10.
0:03:48 - 0:03:50, Với lại cái thành phần còn lại.
0:03:50 - 0:03:51, Đây chính là cái phép nhân.
0:03:51 - 0:03:56, Hàm p là product, viết tắt của chữ product.
0:03:56 - 0:04:02, Tức là phép nhân của theta 10, cái tham số 10 với lại cái kết quả đầu ra trước đó.
0:04:02 - 0:04:07, Thì p10 và p1 chính là cái phép này.
0:04:07 - 0:04:09, Đây chính là p1.
0:04:09 - 0:04:17, Thế thì cái phép theta 1 nhân vx thì đây chính là cái hàm p1.
0:04:17 - 0:04:19, Rồi.
0:04:19 - 0:04:25, Thế thì chúng ta triển khai cái chain rule ra thì chúng ta sẽ có cái công thức như trên.
0:04:25 - 0:04:32, Và chúng ta để ý đó là cái hàm đạo hàm của sigmoid được thực hiện đi thực hiện lại 10 lần.
0:04:32 - 0:04:38, Chúng ta có bao nhiêu cái lớp biến đổi thì sẽ có bấy nhiêu hàm sigmoid.
0:04:38 - 0:04:41, Thì ở đây chúng ta có tất cả là 10 lớp biến đổi.
0:04:41 - 0:04:45, Do đó nó sẽ có 10 lần cái đạo hàm của sigmoid.
0:04:47 - 0:04:50, P1 cho đến p10.
0:04:50 - 0:04:54, Và mặt khác thì chúng ta lại có cái công thức của đạo hàm.
0:04:54 - 0:04:59, Ở đây chúng ta có hàm sigmoid là cái công thức như trên.
0:04:59 - 0:05:08, Thì hoặc là chúng ta có thể tính nháp bằng tay để chứng minh được đạo hàm của sigmoid là bằng sigmoid nhân với 1 trừ sigmoid.
0:05:08 - 0:05:16, Hoặc là chúng ta có thể tra cứu các tài liệu học thuật online để có được xác nhận công thức này.
0:05:16 - 0:05:19, Và cơ bản thì công thức này cũng rất dễ chứng minh.
0:05:19 - 0:05:25, Lý do đó là vì trong cái đạo hàm này, trong cái công thức của hàm sigmoid này nó có e mũ x.
0:05:25 - 0:05:28, Mà e mũ x là một cái hàm rất dễ tính đạo hàm.
0:05:28 - 0:05:35, Rồi thì bây giờ chúng ta xem như chúng ta đã biết cái đạo hàm của sigmoid bằng sigmoid nhân với 1 trừ sigmoid.
0:05:35 - 0:05:37, Thì chúng ta áp dụng cái bất đẳng thức Cô-si.
0:05:37 - 0:05:39, Ở đây là dấu bé hơn hoặc bằng.
0:05:39 - 0:05:41, Chúng ta áp dụng cái bất đẳng thức Cô-si.
0:05:41 - 0:05:50, Đó là đạo hàm của sigmoid x nhân cho 1 trừ cho sigmoid x.
0:05:51 - 0:06:00, Thì nó sẽ bé hơn hoặc bằng tổng của 2 phần tử này.
0:06:00 - 0:06:01, Tất cả bình chia 4.
0:06:01 - 0:06:07, Tức là sigmoid x cộng cho 1 trừ sigmoid x.
0:06:07 - 0:06:10, Tất cả bình phương.
0:06:10 - 0:06:12, Rồi chia cho 4.
0:06:12 - 0:06:16, Thì sigmoid cộng 1 trừ sigmoid khử.
0:06:16 - 0:06:18, Thì chúng ta sẽ còn là 1.
0:06:18 - 0:06:20, Như vậy đó sẽ là bằng 1 phần tư.
0:06:20 - 0:06:26, Như vậy thì áp dụng cái bất đẳng thức Cô-si thì chúng ta thấy là đạo hàm của sigmoid sẽ bé hơn 1 phần tư.
0:06:26 - 0:06:28, Tức là 0.25.
0:06:28 - 0:06:34, Vậy thì với cái đạo hàm này mà bằng 0.25 thì điều gì xảy ra?
0:06:34 - 0:06:48, Với cái công thức đạo hàm của G theo theta y, nó có đến sự xuất hiện của đạo hàm sigmoid đến 10 lần.
0:06:48 - 0:07:02, Tức là ngoài các thành phần kia thì chúng ta sẽ thấy là thành phần đạo hàm sigmoid sẽ bé hơn hoặc bằng 0.25.
0:07:02 - 0:07:06, Vậy là 0.25 là mũ 10.
0:07:06 - 0:07:10, Rồi xong đó nhân với cái thành phần đạo hàm còn lại.
0:07:10 - 0:07:18, Vậy thì bây giờ chúng ta sẽ xem xét cái 0.25 mũ 10 này nếu chúng ta lấy máy tính bấm thì nó sẽ xấp xỉ là bằng 0.
0:07:18 - 0:07:20, Nó là 1 con số rất là bé.
0:07:20 - 0:07:22, 0.0001 ví dụ vậy.
0:07:22 - 0:07:30, Và với cái khả năng biểu diễn của máy tính thì thậm chí đó là cái con số này có thể tự động được làm tròn bằng số 0.
0:07:30 - 0:07:34, Là vì cái khả năng biểu diễn nó không có khả năng biểu diễn những con số quá bé.
0:07:34 - 0:07:36, Thì không nhân với bao nhiêu cũng sẽ là bằng 0.
0:07:36 - 0:07:40, Do đó thì cái đạo hàm này nó sẽ được tiến về 0.
0:07:40 - 0:07:46, Và đây chính là cái cốt lõi gây ra cái hiện tượng vanishing gradient.
0:07:46 - 0:07:54, Tức là đạo hàm của thằng G hàm lỗi theo theta y bằng 0.
0:07:54 - 0:08:02, Thì khi đó cái việc cập nhật theta y bằng theta y trừ cho alpha nhân cho đạo hàm.
0:08:02 - 0:08:06, Thì cái giá trị này xấp xỉ bằng 0.
0:08:06 - 0:08:10, Nên cái bước cập nhật này sẽ gần như xấp xỉ bằng y.
0:08:10 - 0:08:12, Tức là không cập nhật.
0:08:12 - 0:08:14, Gần như không cập nhật.
0:08:14 - 0:08:18, Cái tham số.
0:08:18 - 0:08:22, Gần như nó không cập nhật tham số.
0:08:22 - 0:08:26, Thì đây là một cái ví dụ trực quan.
0:08:26 - 0:08:30, Và đây là một cái ví dụ mà có số liệu tính toán.
0:08:30 - 0:08:38, Để cho chúng ta hình dung là tại sao cái công thức đạo hàm của mình nó sẽ tiến về 0.
0:08:38 - 0:08:44, Khi có quá nhiều cái hàm kích hoạt chập lại.
0:08:44 - 0:08:48, Và cái hàm kích hoạt này có cái đạo hàm bé hơn 1.
0:08:48 - 0:08:52, Vì vậy nó sẽ tiến cho tích này của chúng ta nó sẽ mau chóng tiến về 0.
0:08:52 - 0:09:04, Và Lưu ý, đó là cái việc tính đạo hàm này nó sẽ đặc biệt đó là dễ tiến về 0 khi cái theta y của mình gần lớp số 1.
0:09:04 - 0:09:12, Còn nếu như cái theta y của mình nằm trong cái nhóm theta 10 thì cái công thức này nó sẽ ít hơn.
0:09:12 - 0:09:14, Nó sẽ ít bị ảnh hưởng hơn.
0:09:14 - 0:09:20, Chúng ta có một cái theta z là thuộc cái tham số của theta 10.
0:09:20 - 0:09:26, Theta z là thuộc cái theta 10.
0:09:26 - 0:09:30, Tức là tập hợp các cái tham số ở lớp cuối cùng.
0:09:30 - 0:09:38, Thế thì cái công thức này của chúng ta theta z, delta z trên theta z.
0:09:38 - 0:09:44, Thế thì sẽ là bằng đạo hàm của binary cross entropy theo sigmoid.
0:09:44 - 0:09:52, Sau đó sẽ là đạo hàm của hàm sigmoid theo cái biến theta z này.
0:09:52 - 0:09:56, Tại vì chúng ta chỉ tính đến cái theta z này là chúng ta sẽ dừng.
0:09:56 - 0:10:02, Do đó thì chúng ta chỉ việc tính cái giá trị đạo hàm của sigmoid này đúng có một lần thôi.
0:10:02 - 0:10:08, Cho dù cái giá trị này nó bé hơn 0.25 nhưng mà chúng ta chỉ nhân có một lần thì nó sẽ không có ảnh hưởng.
0:10:08 - 0:10:12, Còn những cái theta y nào mà nó nằm ở cái lớp đầu tiên.
0:10:12 - 0:10:20, Lưu ý là ở đây chúng ta đang xét cái theta y thuộc những cái layer đầu tiên.
0:10:20 - 0:10:30, Thì nó sẽ phải kéo từ cái phép biến đổi sigmoid thứ 10, thứ 9 và cho đến cái hàm sigmoid thứ 9.
0:10:30 - 0:10:34, Và cho đến cái hàm sigmoid số 1.
0:10:34 - 0:10:46, Rồi thì đây là một cái giải thích thêm cho cái việc đó là tại sao cái tham số mà càng gần cái layer đầu thì dễ bị hiện tượng vanishing gradient.
0:10:46 - 0:10:52, Tức là nó cập nhật chậm. Còn những cái tham số ở những cái lớp cuối cùng thì ít bị hiện tượng vanishing gradient hơn.
0:10:52 - 0:11:00, Vì nó đã cập nhật đến những cái tham số cuối cùng thì nó sẽ dừng ở đó.
0:11:00 - 0:11:06, Và nó không có thực hiện cái phép nhân nhiều lần. Nhân đạo hàm nhiều lần.